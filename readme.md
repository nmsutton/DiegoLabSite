Diego lab site developer guide

Version 1.0

By: Nate Sutton and Amol Bhalla (original site design)

Copyright 2014


Code for http://diego.asu.edu



Introduction

Hello and thank you for choosing to develop with this site. The file structure is mainly: base directory contains html and php for main pages of the site, sub directories have modules or subpage content.  Ac cross the site the pages share the pages: SiteTop.html, SiteUpperMiddle.html, SiteSecondUpperMiddle.html, loginMenu.php, SiteFooter.html.  Editing those pages effects all pages across the site.  Main pages such as Welcome.php include specific content for the welcome page and load WelcomeBody.html, the user editable content on that page.  All *Body.html pages are able to be modified by logged in users and are kept separate from the backend code of the site.  


Editing Html

Access to the Site Manager:

You will need the superuser username/password to log into the site manager at https://webhost290.asu.edu:2222/ to be able to have direct access to html and other site files. Please contact one of the individuals listed on the Contact page on the site to get the superuser credentials if you want them. The site is in the /domains/diego.asu.edu/public_html/NewSite/ directory.

Site Backups:

Before editing the source code in the site please make a backup of its contents. One preferred way to backup the site is to use the site manager (DirectAdmin) and go to the file manager. Enter the base directory of the site (where Welcome.php is). On the bottom of the file manager click Empty Clipboard. On the top right click the Select link and all files should be selected. Click Add To Clipboard at the page bottom. Enter the Downloads directory. At the page bottom where it is written Compress Clipboard enter a name for a zip archive file and click create. Download the created file. Now you have a backup in the downloaded file. Delete the file you made after you download it. A second way to backup the site is to click Create or Restore Backups from the DirectAdmin main menu. The problem with that is that every file is backed up even old site directories and that can add another 50-100Mb file which can be downloaded and deleted from the server but if left there takes up extra room.

Creating New Pages:

This site is meant to be practical to customize with its basic file structure, no cms, and reuse of shared page content on all pages.  A new main page on the site can be created based on using an example page for a template such as Publications2.php.  Copy the contents of that file into a new file and customize it based on the purpose of the new page.

Changing visual styles:

Visual styles for the site are mainly kept in /Css/styles.css or style2.css.  Recommended advice for changing a visual style is to use Chrome and right click on the page element that changes are wanted in and click “inspect element”.  What is looked for here is the id or class of the element that interest is in.  Chrome will show an elements browser and hover over the browser until Chrome highlights the page region you are looking for.  Find the id or class of the region then search for it in styles.css or style2.css.  Use css to modify it.  Graphics of the site are stored in the /Images folder.


Editing Script Code

Working with the Site's Scripting Language Code:

Php and Javascript are the languages used here.  Logged in members have an authorized user menu on the top right that is generated by using JQuery to replace the content of the div with the id “buttonheading” with the menu.

PhpSecurePages:

This is some open source software used in the site.  Customizations have been made to it for the site.    In pages in the site php including “secure.php” in pages blocks unauthorized users from viewing or accessing page content after that code to include the file on the pages.  Loginmenu.php contains the initial access of the software and generates the login menu on the site.  PhpSecurePages/interface.php is accessed which includes a html form that can submit data to secure.php.  Secure.php includes /checklogin_data2.php.  If security checks in  checklogin_data2.php are passed than at the bottom of file cookies are set for the login username, password, and correctAuthentication.  Files are then accessed again and when secure.php is reached if the  correctAuthentication cookie is positive than a logged in as … display replaces the login menu content.  The cookies are used in all pages to allow logged in users to edit and modify site contents.

PhpFileUploader:

fileUpload.php links to this open source software to upload user's files.

Adding Users or Profile Pages:

addUserProfilePage.php contains content for accessing the code for adding users to /phpSecurePages/config.php and adding profile pages.  Adding a profile page automatically creates additions to the appropriate /LabMembers/<typeOfMember>Body.html file and /<typeOfMember>/<memberName>.html file.  Those two files are logged in user editable.

Logged In User Content Editing:

TinyMCE is used as an on site document editor that appears when users select to edit page content.  It targets the div with the id “contentArea”.  Using the submit edits button dynamically updates which page target to write to with writePageUpdate.php.


Notes

All logged in user editable or modifiable pages and directories have a permissions setting of 777 because it was read that php needs that to modify pages, if it is found less access can still write pages with php that can be changed.
